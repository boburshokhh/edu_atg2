# План реализации CoursePlayer согласно шаблону code.html

## Анализ шаблона code.html

### Структура шаблона:
1. **Header** (sticky, top-0)
   - Логотип/иконка + название курса слева
   - Кнопка языка + профиль пользователя справа
   - Backdrop blur эффект

2. **Sidebar** (w-80, скрыт на мобильных)
   - Заголовок "The Path" с кнопкой сворачивания
   - Навигация по урокам (expandable)
   - Статусы тем: completed (зеленая галочка), active (синий play), pending (серый круг)

3. **Main Content** (flex-1, overflow-y-auto)
   - Breadcrumb навигация
   - Заголовок темы (h1, text-3xl lg:text-4xl)
   - Progress bar (35% в примере)
   - **PDF Viewer Container**:
     - Панель инструментов: zoom in/out, счетчик страниц
     - Контейнер с прокруткой (h-[600px])
     - Все страницы PDF отображаются вертикально с прокруткой
   - **Grid с двумя колонками**:
     - **Supplementary Paths** (Дополнительные материалы):
       - Карточки материалов с иконками (PDF, видео, ссылки)
       - Разные цвета для разных типов файлов
     - **Collective Echoes** (Комментарии/Обсуждения):
       - Заглушка для будущей функциональности
   - **Navigation** (Prev/Next кнопки)

## Текущая структура данных

### Из courseMaterials.json:
```json
{
  "lessons": [{
    "lessonTitle": "...",
    "topics": [{
      "topicCode": "Тема 1.1",
      "topicTitle": "...",
      "files": [{
        "fileName": "...",
        "objectName": "...",
        "is_main_file": true/false,
        "fileType": "pdf" | "video",
        "fileSize": number,
        "sizeFormatted": "..."
      }]
    }]
  }]
}
```

### Из StationCourses.vue:
- `curriculum` computed содержит:
  - `lesson.topics[].mainPdfs[]` - массив основных PDF
  - `lesson.topics[].additionals[]` - массив дополнительных материалов (PDF, видео)

## План реализации по этапам

### Этап 1: Обновление структуры компоненты
**Цель:** Привести структуру к шаблону code.html

**Задачи:**
1. Обновить Header согласно шаблону
2. Обновить Sidebar с правильными стилями и иконками
3. Переструктурировать Main Content:
   - Breadcrumb
   - Заголовок темы
   - Progress bar
   - PDF Viewer (новый дизайн)
   - Grid с дополнительными материалами
   - Navigation

**Файлы:**
- `src/components/CoursePlayer.vue`

---

### Этап 2: Реализация PDF Viewer с прокруткой
**Цель:** PDF отображается со всеми страницами в прокручиваемом контейнере

**Задачи:**
1. Изменить контейнер PDF на фиксированную высоту (600px) с overflow-y-auto
2. Отображать все страницы вертикально (flex-col, space-y-4)
3. Обновить панель инструментов:
   - Zoom in/out кнопки
   - Счетчик "Scroll X of Y" (текущая видимая страница)
4. Реализовать отслеживание видимой страницы при скролле
5. Использовать pdfService для рендеринга всех страниц

**Технические детали:**
- Использовать Intersection Observer для определения видимой страницы
- Масштабирование через CSS transform (как сейчас)
- Оптимизация: lazy loading страниц при прокрутке (опционально)

---

### Этап 3: Блок дополнительных материалов
**Цель:** Красивое отображение дополнительных материалов в grid формате

**Задачи:**
1. Создать grid layout (grid-cols-1 lg:grid-cols-2)
2. Для каждого дополнительного материала:
   - Определить тип (PDF, видео, ссылка)
   - Показать соответствующую иконку с цветным фоном:
     - PDF: `bg-red-500/10 text-red-500` с иконкой `picture_as_pdf`
     - Видео: `bg-purple-500/10 text-purple-500` с иконкой `play_circle`
     - Документ: `bg-primary/10 text-primary` с иконкой `description`
     - Ссылка: `bg-green-500/10 text-green-500` с иконкой `link`
   - Показать название и размер файла
   - Кнопка действия (просмотр/открыть)
3. Обработка кликов:
   - PDF: открыть в новом окне или модальном просмотрщике
   - Видео: открыть VideoPlayer компоненту
   - Ссылки: открыть в новой вкладке

**Структура карточки:**
```html
<div class="flex items-center gap-4 p-4 border rounded-lg bg-white">
  <div class="size-10 rounded-lg bg-[color]/10 text-[color]">
    <span class="material-symbols-outlined">[icon]</span>
  </div>
  <div class="flex-1">
    <h3 class="font-semibold">Название</h3>
    <p class="text-sm text-gray-500">Размер</p>
  </div>
  <button class="p-2 rounded-full hover:bg-gray-100">
    <span class="material-symbols-outlined">visibility</span>
  </button>
</div>
```

---

### Этап 4: Блок комментариев (Collective Echoes)
**Цель:** Добавить заглушку для будущей функциональности

**Задачи:**
1. Создать блок с заголовком "Обсуждения" или "Комментарии"
2. Показать счетчик комментариев (если есть)
3. Добавить placeholder с текстом "Пространство для обсуждений"
4. Стилизация согласно шаблону (border-dashed, rounded-lg)

---

### Этап 5: Адаптивность и мобильная версия
**Цель:** Полная адаптивность для всех устройств

**Задачи:**
1. **Мобильная версия (< 1024px):**
   - Скрыть sidebar (уже есть `hidden lg:block`)
   - Добавить мобильное меню (hamburger) для навигации
   - Уменьшить размеры шрифтов
   - Grid материалов: 1 колонка на мобильных
   - PDF viewer: уменьшить высоту на мобильных (h-[400px])
   
2. **Планшетная версия (768px - 1023px):**
   - Sidebar скрыт
   - Grid: 1 колонка
   - PDF viewer: h-[500px]

3. **Desktop версия (>= 1024px):**
   - Полная версия с sidebar
   - Grid: 2 колонки
   - PDF viewer: h-[600px]

**Брейкпоинты:**
- Mobile: < 768px
- Tablet: 768px - 1023px
- Desktop: >= 1024px

---

### Этап 6: Интеграция с VideoPlayer
**Цель:** Правильная обработка видео файлов

**Задачи:**
1. Импортировать VideoPlayer компоненту
2. Добавить состояние для показа видеоплеера
3. При клике на видео файл:
   - Открыть VideoPlayer в модальном окне
   - Передать URL видео и метаданные
4. Обработать закрытие видеоплеера

---

### Этап 7: Улучшение UX и анимаций
**Цель:** Плавные переходы и улучшенный UX

**Задачи:**
1. Добавить плавные переходы при смене темы
2. Loading states для PDF загрузки
3. Error states для недоступных файлов
4. Hover эффекты для интерактивных элементов
5. Плавная прокрутка к началу при смене темы

---

### Этап 8: Оптимизация производительности
**Цель:** Оптимизация загрузки и рендеринга

**Задачи:**
1. Lazy loading PDF страниц (загружать по мере прокрутки)
2. Кэширование загруженных PDF
3. Оптимизация масштабирования (не перерисовывать все страницы при zoom)
4. Debounce для scroll events

---

## Технические детали

### Используемые библиотеки:
- `pdfjs-dist` (уже в package.json) - для рендеринга PDF
- `@heroicons/vue` - для иконок
- Material Symbols (через Google Fonts) - для иконок в стиле шаблона

### Цветовая схема (из шаблона):
- Primary: `#359EFF` (blue-500)
- Background light: `#f5f7f8` (gray-50)
- Background dark: `#0f1923` (для dark mode, опционально)
- Border: `gray-200` / `gray-800` (dark mode)

### Типографика:
- Заголовки: `font-bold tracking-tight`
- Основной текст: стандартный
- Размеры: responsive (text-3xl lg:text-4xl для h1)

---

## Порядок реализации

1. ✅ **Этап 1** - Обновление структуры (базовая разметка)
2. ✅ **Этап 2** - PDF Viewer с прокруткой
3. ✅ **Этап 3** - Блок дополнительных материалов
4. ✅ **Этап 4** - Блок комментариев (заглушка)
5. ✅ **Этап 5** - Адаптивность
6. ✅ **Этап 6** - Интеграция VideoPlayer
7. ✅ **Этап 7** - UX улучшения
8. ⏳ **Этап 8** - Оптимизация (опционально, можно позже)

---

## Критерии успеха

- ✅ Дизайн соответствует шаблону code.html
- ✅ PDF отображается со всеми страницами в прокручиваемом контейнере
- ✅ Дополнительные материалы отображаются в grid формате
- ✅ Полная адаптивность для всех устройств
- ✅ Интеграция с VideoPlayer для видео файлов
- ✅ Плавные переходы и хороший UX
- ✅ Использование материалов из StationCourses.vue
- ✅ Использование pdfService для рендеринга PDF

