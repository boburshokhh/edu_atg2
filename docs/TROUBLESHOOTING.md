# üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

## –û—à–∏–±–∫–∞ "Connection Refused" –ø—Ä–∏ –≤—Ö–æ–¥–µ

### –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –≤—Ö–æ–¥–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –æ—à–∏–±–∫–∞:
```
Connection refused
http://localhost:8000/auth/login
```

### –ü—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è

#### 1. Django —Å–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω

**–†–µ—à–µ–Ω–∏–µ**: –ó–∞–ø—É—Å—Ç–∏—Ç–µ Django —Å–µ—Ä–≤–µ—Ä

```bash
cd backend_django
python manage.py runserver
```

–ò–ª–∏ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø–æ—Ä—Ç–∞:
```bash
python manage.py runserver 8000
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞**: –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ `http://localhost:8000/health` - –¥–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è `{"ok": true}`

#### 2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—Ç

–ï—Å–ª–∏ Django –∑–∞–ø—É—â–µ–Ω –Ω–∞ –¥—Ä—É–≥–æ–º –ø–æ—Ä—Ç—É, –æ–±–Ω–æ–≤–∏—Ç–µ `frontend.env`:

```env
VITE_API_TARGET=http://localhost:–ü–û–†–¢
```

–ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ Django –Ω–∞ –ø–æ—Ä—Ç—É 3003:
```env
VITE_API_TARGET=http://localhost:3003
```

**–í–∞–∂–Ω–æ**: –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `frontend.env` –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Vite dev —Å–µ—Ä–≤–µ—Ä:
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å (Ctrl+C)
npm run dev
```

#### 3. –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∫—Å–∏ Vite

–í dev —Ä–µ–∂–∏–º–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ–∫—Å–∏ `/api` ‚Üí `http://localhost:8000`. 

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∫—Å–∏**:
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `vite.config.js` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–æ–∫—Å–∏:
```javascript
'/api': {
  target: 'http://localhost:8000',
  changeOrigin: true,
  rewrite: (path) => path.replace(/^\/api/, '')
}
```

2. –í dev —Ä–µ–∂–∏–º–µ –∑–∞–ø—Ä–æ—Å—ã –¥–æ–ª–∂–Ω—ã –∏–¥—Ç–∏ –Ω–∞ `/api/auth/login`, –∞ –Ω–µ –Ω–∞ `http://localhost:8000/auth/login`

#### 4. CORS –æ—à–∏–±–∫–∏

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ CORS –æ—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CORS –≤ `backend_django/atg_backend/settings.py`:
```python
CORS_ALLOW_ALL_ORIGINS = True  # –î–ª—è dev
# –∏–ª–∏
CORS_ALLOWED_ORIGINS = ['http://localhost:5173']  # –î–ª—è prod
```

2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `django-cors-headers` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
```bash
pip install django-cors-headers
```

#### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

**–®–∞–≥ 1**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Django —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω
```bash
curl http://localhost:8000/health
# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è: {"ok": true}
```

**–®–∞–≥ 2**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ endpoint –ª–æ–≥–∏–Ω–∞
```bash
curl -X POST http://localhost:8000/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"test","password":"test"}'
```

**–®–∞–≥ 3**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
–û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) ‚Üí Network ‚Üí –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ–π—Ç–∏ ‚Üí –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–ø—Ä–æ—Å

### –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –∑–∞–ø—É—â–µ–Ω –ª–∏ Django**:
   ```bash
   # Windows PowerShell
   netstat -ano | findstr :8000
   
   # Linux/Mac
   lsof -i :8000
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Django**:
   –í –∫–æ–Ω—Å–æ–ª–∏ –≥–¥–µ –∑–∞–ø—É—â–µ–Ω Django –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∏–¥–Ω—ã –∑–∞–ø—Ä–æ—Å—ã:
   ```
   [24/Jan/2025 10:00:00] "POST /auth/login HTTP/1.1" 401
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞**:
   –û—Ç–∫—Ä–æ–π—Ç–µ DevTools (F12) ‚Üí Console ‚Üí –∏—â–∏—Ç–µ –æ—à–∏–±–∫–∏

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Network tab**:
   DevTools ‚Üí Network ‚Üí –Ω–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å `/api/auth/login` –∏–ª–∏ `http://localhost:8000/auth/login`
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL –∑–∞–ø—Ä–æ—Å–∞
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏

#### "Network Error" –∏–ª–∏ "Failed to fetch"
- Django —Å–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL –≤ `VITE_API_TARGET`
- –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é/firewall

#### "401 Unauthorized"
- –ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ü—Ä–æ–±–ª–µ–º—ã —Å LDAP (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω)
- –ü—Ä–æ–±–ª–µ–º—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

#### "500 Internal Server Error"
- –û—à–∏–±–∫–∞ –≤ –∫–æ–¥–µ Django
- –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–±–ª–µ–º—ã —Å LDAP —Å–µ—Ä–≤–µ—Ä–æ–º

#### "CORS policy"
- –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω CORS –≤ Django
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `CORS_ORIGINS`

### –†–µ—à–µ–Ω–∏–µ –¥–ª—è –≤–∞—à–µ–≥–æ —Å–ª—É—á–∞—è

–°—É–¥—è –ø–æ –æ—à–∏–±–∫–µ `connection refused http://localhost:8000/auth/login`, –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ:

1. **Django —Å–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω** - –∑–∞–ø—É—Å—Ç–∏—Ç–µ –µ–≥–æ:
   ```bash
   cd backend_django
   python manage.py runserver
   ```

2. **–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL** - –≤ dev —Ä–µ–∂–∏–º–µ –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è `/api` (–ø—Ä–æ–∫—Å–∏), –∞ –Ω–µ –ø—Ä—è–º–æ–π URL.

   –ö–æ–¥ —É–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –≤ `auth.js` - —Ç–µ–ø–µ—Ä—å –≤ dev —Ä–µ–∂–∏–º–µ –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `/api`.

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Vite dev —Å–µ—Ä–≤–µ—Ä** –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:
   ```bash
   npm run dev
   ```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Django:
   ```bash
   cd backend_django
   python manage.py runserver
   ```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Vite:
   ```bash
   npm run dev
   ```

3. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ–π—Ç–∏

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ `/api/auth/login`

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 2025-01-24

